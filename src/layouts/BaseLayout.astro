---
import '../styles/global.css';

interface Props {
  title?: string;
  description?: string;
}

const { title = "Pinkaru's Blog", description = "Code, Science, Philosophy, Humor" } = Astro.props;
const pageTitle = title === "Pinkaru's Blog" ? title : `${title} | Pinkaru's Blog`;
---

<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content={description}>
  <title>{pageTitle}</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
</head>
<body class="min-h-screen flex flex-col">
  <!-- Hero Header -->
  <header class="bg-gradient-to-r from-gray-800 to-gray-900 text-white py-16">
    <div class="container mx-auto px-4">
      <h1 class="text-5xl font-bold mb-4">
        <span id="typewriter" class="inline-block min-w-[200px]">Pinkaru</span>
      </h1>
      <h4 class="text-xl text-gray-300" id="quote">
        {description}
      </h4>
    </div>
  </header>

  <!-- Navigation -->
  <nav class="bg-white shadow-md sticky top-0 z-50">
    <div class="container mx-auto px-4">
      <div class="flex items-center justify-between h-16">
        <div class="flex items-center space-x-6">
          <a href="/" class="text-gray-700 hover:text-secondary transition-colors">
            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
              <path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"></path>
            </svg>
          </a>
          <a href="https://github.com/pinkaru" class="text-gray-700 hover:text-secondary transition-colors" target="_blank" rel="noopener">
            GitHub
          </a>
        </div>
        <div class="flex items-center space-x-6">
          <a href="/blog" class="text-gray-700 hover:text-secondary transition-colors">Archive</a>
          <a href="/tags" class="text-gray-700 hover:text-secondary transition-colors">Tags</a>
        </div>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="flex-grow container mx-auto px-4 py-8">
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
      <!-- Main Content Area -->
      <div class="lg:col-span-2">
        <slot />
      </div>

      <!-- Sidebar -->
      <aside class="space-y-6">
        <!-- Recent Posts Widget -->
        <div class="card">
          <h3 class="text-xl font-bold mb-4 text-primary">Recent Posts</h3>
          <ul class="space-y-2" id="recent-posts">
            <!-- Will be populated dynamically -->
          </ul>
        </div>

        <!-- Sponsored Widget -->
        <div class="card">
          <h3 class="text-xl font-bold mb-4 text-primary">Sponsored</h3>
          <img src="/images/Dust_Bunny.jpg" alt="Dust Bunny" class="w-full rounded-md">
        </div>

        <!-- Recommended Websites -->
        <div class="card">
          <h3 class="text-xl font-bold mb-4 text-primary">Recommended Websites</h3>
          <ul class="space-y-2 text-gray-700">
            <li><a href="https://xkcd.com" class="hover:text-secondary transition-colors">xkcd</a></li>
            <li><a href="http://commitstrip.com" class="hover:text-secondary transition-colors">Commit Strip</a></li>
            <li><a href="http://www.smbc-comics.com" class="hover:text-secondary transition-colors">SMBC Comics</a></li>
            <li><a href="https://blog.codinghorror.com" class="hover:text-secondary transition-colors">Coding Horror</a></li>
            <li><a href="http://waitbutwhy.com" class="hover:text-secondary transition-colors">Wait But Why</a></li>
          </ul>
        </div>
      </aside>
    </div>
  </main>

  <!-- Footer -->
  <footer class="bg-gray-800 text-white py-8 mt-auto">
    <div class="container mx-auto px-4 text-center">
      <p class="mb-2">Some rights reserved.</p>
      <p class="mb-4">
        Made with ❤️ and <a href="https://astro.build" class="text-secondary hover:underline">Astro</a>,
        <a href="https://tailwindcss.com" class="text-secondary hover:underline">Tailwind CSS</a>.
        Hosted on <a href="https://github.com" class="text-secondary hover:underline">GitHub</a>
      </p>
      <div class="flex justify-center space-x-4">
        <a href="https://github.com/pinkaru" class="hover:text-secondary transition-colors">GitHub</a>
        <a href="mailto:pinkaru89@gmail.com" class="hover:text-secondary transition-colors">Email</a>
      </div>
    </div>
  </footer>

  <script>
    // Typewriter effect
    const words = ["hello", "하이", "핀카루", "Pinkaru"];
    let wordIndex = 0;
    let charIndex = 0;
    let isDeleting = false;
    const typewriterElement = document.getElementById('typewriter');

    function type() {
      if (!typewriterElement) return;

      const currentWord = words[wordIndex];

      if (isDeleting) {
        typewriterElement.textContent = currentWord.substring(0, charIndex - 1);
        charIndex--;
      } else {
        typewriterElement.textContent = currentWord.substring(0, charIndex + 1);
        charIndex++;
      }

      if (!isDeleting && charIndex === currentWord.length) {
        isDeleting = true;
        setTimeout(type, 2000);
      } else if (isDeleting && charIndex === 0) {
        isDeleting = false;
        wordIndex = (wordIndex + 1) % words.length;
        setTimeout(type, 500);
      } else {
        setTimeout(type, isDeleting ? 50 : 150);
      }
    }

    // Start typewriter
    if (typewriterElement) {
      setTimeout(type, 1000);
    }

    // Load random quote
    fetch('/quotes.txt')
      .then(response => response.text())
      .then(data => {
        const quotes = data.split('\n').filter(q => q.trim());
        const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];
        const quoteElement = document.getElementById('quote');
        if (quoteElement) {
          quoteElement.textContent = randomQuote;
        }
      })
      .catch(() => {
        console.log('Failed to load quotes');
      });
  </script>
</body>
</html>
