---
import CactusLayout from '../../layouts/CactusLayout.astro';
import { getCollection } from 'astro:content';

const allPosts = await getCollection('blog');
const allTags = [...new Set(allPosts.flatMap(post => post.data.tags || []))].sort();
const tagCounts = allTags.map(tag => ({
  tag,
  count: allPosts.filter(post => post.data.tags?.includes(tag)).length
}));
---

<CactusLayout title="Tags">
  <section>
    <h1 class="text-4xl font-bold mb-12">All Tags</h1>

    <div class="flex flex-wrap gap-3">
      {tagCounts.map(({ tag, count }) => (
        <a
          href={`/tags/${tag}`}
          class="px-4 py-2 bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-accent hover:text-white dark:hover:bg-blue-500 rounded-lg transition-colors font-medium no-underline"
        >
          #{tag} <span class="text-sm opacity-70">({count})</span>
        </a>
      ))}
    </div>
  </section>
</CactusLayout>
